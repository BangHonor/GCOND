Namespace(gpu_id=0, dataset='ogbn-arxiv', dis_metric='ours', epochs=1000, nlayers=2, hidden=256, lr_adj=0.01, lr_feat=0.01, lr_model=0.01, weight_decay=0.0, dropout=0.5, normalize_features=True, keep_ratio=1.0, reduction_rate=0.005, seed=1, alpha=0, debug=0, sgc=1, inner=10, outer=20, save=1, model='DeeperGCN', deep_layers=28, deep_hidden=128, mlp_layers=1, block='res+', conv='gen', gcn_aggr='softmax_sg', t=0.1, p=1.0, y=0.0, learn_t=False, learn_p=False, learn_y=False, norm='batch', msg_norm=True, learn_msg_scale=True, model_save_path='model_ckpt', model_load_path='ogbn_arxiv_pretrained_model.pth')
pyg_data: Data(num_nodes=169343, x=[169343, 128], node_year=[169343, 1], y=[169343, 1], adj_t=[169343, 169343, nnz=1166243])
split_index: {'train': tensor([     0,      1,      2,  ..., 169145, 169148, 169251]), 'valid': tensor([   349,    357,    366,  ..., 169185, 169261, 169296]), 'test': tensor([   346,    398,    451,  ..., 169340, 169341, 169342])}
size of adj_train: (90941, 90941)
edges in adj_train: 738066.0
WARNING:root:The OGB package is out of date. Your version is 1.3.4, while the latest version is 1.3.5.
adj_syn: (439, 439) feat_syn: torch.Size([439, 128])
开始图凝聚！
Epoch 0, 梯度匹配loss_avg: 7.406993713378906
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
/home/xzb/anaconda3/envs/gd/lib/python3.9/site-packages/torch/utils/checkpoint.py:25: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn("None of the inputs have requires_grad=True. Gradients will be None")
Train set results: loss= 8428.1162 accuracy= 0.0477
Test set results: loss= 7295.2158 accuracy= 0.0953
Epoch 50, 梯度匹配loss_avg: 1.2146369552612304
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 11.1053 accuracy= 0.4150
Test set results: loss= 9.6164 accuracy= 0.4606
Epoch 100, 梯度匹配loss_avg: 0.9170697784423828
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 10.5723 accuracy= 0.4482
Test set results: loss= 9.5069 accuracy= 0.5136
Epoch 150, 梯度匹配loss_avg: 0.8062214565277099
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 11.1884 accuracy= 0.4169
Test set results: loss= 10.5781 accuracy= 0.4536
Epoch 200, 梯度匹配loss_avg: 0.7127756214141846
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 10.9755 accuracy= 0.4390
Test set results: loss= 10.5558 accuracy= 0.4386
Epoch 250, 梯度匹配loss_avg: 0.7063575744628906
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 9.8552 accuracy= 0.4559
Test set results: loss= 8.4750 accuracy= 0.4725
Epoch 300, 梯度匹配loss_avg: 0.6798476505279542
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 8.8023 accuracy= 0.4379
Test set results: loss= 9.9404 accuracy= 0.4670
Epoch 350, 梯度匹配loss_avg: 0.6621765041351318
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 5.1945 accuracy= 0.4734
Test set results: loss= 5.1405 accuracy= 0.4595
Epoch 400, 梯度匹配loss_avg: 0.680945701599121
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 5.2891 accuracy= 0.4215
Test set results: loss= 5.7477 accuracy= 0.4796
Epoch 450, 梯度匹配loss_avg: 0.6518410301208496
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 6.5430 accuracy= 0.4816
Test set results: loss= 6.1171 accuracy= 0.4883
Epoch 500, 梯度匹配loss_avg: 0.6357787418365478
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 5.3213 accuracy= 0.4558
Test set results: loss= 4.6544 accuracy= 0.5102
Epoch 550, 梯度匹配loss_avg: 0.6220975971221924
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 7.6956 accuracy= 0.4558
Test set results: loss= 6.8541 accuracy= 0.4711
Epoch 600, 梯度匹配loss_avg: 0.6410880088806152
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 6.0183 accuracy= 0.4965
Test set results: loss= 5.5022 accuracy= 0.5171
Epoch 650, 梯度匹配loss_avg: 0.620318489074707
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 6.9975 accuracy= 0.4959
Test set results: loss= 7.1269 accuracy= 0.4832
Epoch 700, 梯度匹配loss_avg: 0.6412468147277832
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 6.8205 accuracy= 0.4691
Test set results: loss= 6.5980 accuracy= 0.4748
Epoch 750, 梯度匹配loss_avg: 0.6025081253051758
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 7.2916 accuracy= 0.4910
Test set results: loss= 6.1777 accuracy= 0.5277
Epoch 800, 梯度匹配loss_avg: 0.5835118198394775
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 6.0070 accuracy= 0.4651
Test set results: loss= 6.1832 accuracy= 0.5152
Epoch 850, 梯度匹配loss_avg: 0.5951789855957031
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 6.1610 accuracy= 0.4893
Test set results: loss= 5.6496 accuracy= 0.5070
Epoch 900, 梯度匹配loss_avg: 0.5864744663238526
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 6.2325 accuracy= 0.4815
Test set results: loss= 6.2244 accuracy= 0.4564
Epoch 950, 梯度匹配loss_avg: 0.592340259552002
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 5.2795 accuracy= 0.4559
Test set results: loss= 5.3507 accuracy= 0.4401
Epoch 1000, 梯度匹配loss_avg: 0.5810830783843994
The number of layers 28 Aggregation method softmax_sg block: res+
LN/BN->ReLU->GraphConv->Res
Train set results: loss= 6.8084 accuracy= 0.4708
Test set results: loss= 6.1275 accuracy= 0.4564
图凝聚用时: 9973 秒
